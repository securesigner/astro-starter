---
/**
 * Services Index Page
 * ===================================================
 * Lists all available services.
 * Features:
 * - Service cards with taglines
 * - Glass morphism styling consistent with site design
 * - SEO optimized with structured data
 * - Links to individual service pages
 *
 * URL: /services/
 */

import { getCollection } from 'astro:content';
import { SITE } from '@/data/site';
import Layout from '../../layouts/Layout.astro';
import PageBackground from '../../components/PageBackground.astro';
import AnimatedSection from '../../components/AnimatedSection.astro';
import SectionConnector from '../../components/SectionConnector.astro';
import CTASection from '../../components/CTASection.astro';
import { ArrowRight, CheckCircle } from 'lucide-react';

// Page metadata
const pageTitle = 'Services';
// CUSTOMIZE: Update this description to match your services
const pageDescription = 'Professional services to help your business grow. From web design to consulting and ongoing support, we deliver solutions that make a real difference.';

// Fetch all services, filter drafts
const allServices = await getCollection('services', ({ data }) => {
  // In production, filter out drafts
  return import.meta.env.PROD ? data.draft !== true : true;
});

// Custom sort order
// CUSTOMIZE: Set the display order of your services
const serviceOrder: Record<string, number> = {
  'web-design': 1,
  'consulting': 2,
  'support': 3,
};

const sortedServices = allServices.sort((a, b) => {
  const orderA = serviceOrder[a.slug] ?? 50;
  const orderB = serviceOrder[b.slug] ?? 50;
  return orderA - orderB;
});
---

<Layout
  title={pageTitle}
  description={pageDescription}
  image="/og/services.png"
  type="website"
>
  <!-- Schema.org structured data -->
  <Fragment slot="head">
    <script is:inline type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "ItemList",
      "name": `${SITE.title} Services`,
      "description": pageDescription,
      "url": `${SITE.url}/services/`,
      "numberOfItems": sortedServices.length,
      "itemListElement": sortedServices.map((service, index) => ({
        "@type": "ListItem",
        "position": index + 1,
        "item": {
          "@type": "Service",
          "name": service.data.title,
          "description": service.data.tagline,
          "url": `${SITE.url}/services/${service.slug}/`
        }
      }))
    })} />
  </Fragment>

  <PageBackground>
  <!-- Main Content -->
  <main class="relative z-10 min-h-screen pt-24 pb-16">
    <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">

      <!-- Page Header with Interior Hero Style -->
      <AnimatedSection animation="fade-up" delay={0} as="header" class="mb-16 text-center relative">
        <!-- Decorative Gradient Blobs -->
        <div
          class="absolute -top-8 right-[10%] w-48 h-48 md:w-72 md:h-72 bg-linear-to-br from-emerald-200/30 dark:from-emerald-800/15 to-teal-100/20 dark:to-teal-900/10 rounded-full blur-3xl pointer-events-none"
          aria-hidden="true"
        />
        <div
          class="absolute top-12 left-[5%] w-32 h-32 md:w-48 md:h-48 bg-linear-to-tr from-amber-100/40 dark:from-amber-900/20 to-orange-100/30 dark:to-orange-900/15 rounded-full blur-2xl pointer-events-none"
          aria-hidden="true"
        />

        <p class="text-sm font-medium uppercase tracking-wide text-emerald-600 dark:text-emerald-400 mb-4">
          Our Services
        </p>
        <h1 class="text-4xl font-bold tracking-tight text-gray-900 dark:text-gray-100 sm:text-5xl lg:text-6xl relative z-10">
          How We <span class="bg-linear-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent">Help</span>
        </h1>
        <!-- CUSTOMIZE: Update this description to match your services -->
        <p class="mt-6 text-lg text-gray-600 dark:text-gray-400 max-w-3xl mx-auto relative z-10">
          Struggling with an outdated website? Need expert guidance on your next project? We help businesses like yours build a stronger digital presence and work more efficiently.
        </p>
      </AnimatedSection>

      <SectionConnector variant="curve" color="cool" class="mb-8" />

      <!-- Services Grid -->
      <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
        {sortedServices.map((service, index) => (
          <AnimatedSection animation="fade-up" delay={index * 75}>
            <a
              href={`/services/${service.slug}/`}
              class="group block h-full rounded-xl bg-white/60 dark:bg-gray-900/60 backdrop-blur-sm border border-gray-100/50 dark:border-gray-800/50 p-6 transition-all duration-300 hover:-translate-y-1 hover:border-emerald-200/50 dark:hover:border-emerald-700/50 hover:shadow-lg hover:shadow-emerald-500/10"
            >
              <div class="flex flex-col h-full">
                {/* Service Title */}
                <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100 group-hover:text-emerald-700 dark:group-hover:text-emerald-400 transition-colors">
                  {service.data.title}
                </h2>

                {/* Tagline */}
                <p class="mt-3 text-gray-600 dark:text-gray-400 line-clamp-3 flex-grow">
                  {service.data.tagline}
                </p>

                {/* Benefits preview */}
                {service.data.benefits && service.data.benefits.length > 0 && (
                  <ul class="mt-4 space-y-2">
                    {service.data.benefits.slice(0, 2).map((benefit) => (
                      <li class="flex items-start gap-2 text-sm text-gray-500 dark:text-gray-400">
                        <CheckCircle className="mt-0.5 h-4 w-4 flex-shrink-0 text-emerald-600 dark:text-emerald-400" />
                        <span class="line-clamp-1">{benefit}</span>
                      </li>
                    ))}
                  </ul>
                )}

                {/* CTA indicator */}
                <div class="mt-6 flex items-center gap-2 text-sm font-medium text-emerald-700 dark:text-emerald-400">
                  <span>{service.data.cta_text || 'Learn More'}</span>
                  <ArrowRight className="h-4 w-4 transition-transform group-hover:translate-x-1" />
                </div>
              </div>
            </a>
          </AnimatedSection>
        ))}
      </div>

      {/* Empty state */}
      {sortedServices.length === 0 && (
        <div class="rounded-xl bg-white/60 dark:bg-gray-900/60 backdrop-blur-sm border border-gray-100/50 dark:border-gray-800/50 p-12 text-center">
          <p class="text-gray-500 dark:text-gray-400">No services available at the moment.</p>
        </div>
      )}

    </div>
  </main>

  <SectionConnector variant="wave" color="warm" />
  </PageBackground>

  <!-- CTA Section -->
  <CTASection
    headline="Not sure where to start?"
    description="That's totally normal. Tell us what you're working on and we'll point you in the right directionâ€”no pressure, just a straight answer."
    primaryText="Get Started"
    primaryUrl="/contact/"
  />

</Layout>
